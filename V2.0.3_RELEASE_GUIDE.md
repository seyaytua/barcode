# 🎉 v2.0.3 リリース作成ガイド

## ✅ 修正完了！

**PDF保存の権限エラーを修正しました！**

- ❌ v2.0.2: Windows環境でPDF保存時に PermissionError
- ✅ v2.0.3: tempfile処理を改善して解決

---

## 🚀 リリース作成手順（3分！）

### ステップ1: v2.0.3リリースを作成

1. **このURLを開く：**
   ```
   https://github.com/seyaytua/barcode/releases/new
   ```

2. **フォームに入力：**

   **タグ（Choose a tag）:**
   ```
   v2.0.3
   ```

   **リリースタイトル（Release title）:**
   ```
   Release v2.0.3 - PDF保存エラー修正
   ```

   **説明（Describe this release）:**
   ```markdown
   ## リリース v2.0.3
   
   ### 🔧 バグ修正
   
   **Windows環境でのPDF保存エラーを修正**
   - ✅ PDF作成時の PermissionError を解決
   - ✅ tempfile処理を改善
   - ✅ 備品用・教職員用PDF両方で修正
   
   ### 動作確認
   - ✅ Windows環境でPDF保存が正常動作
   - ✅ バーコード/QRコード生成
   - ✅ Excelインポート/エクスポート
   
   ### ダウンロード
   ビルド完了まで約10分お待ちください。
   
   #### Windows版
   - `BarcodeQRCodePDF_v2-Windows-v2.0.3.zip`
   
   #### macOS版
   - `BarcodeQRCodePDF_v2-macOS-v2.0.3.dmg` または `.zip`
   
   ### システム要件
   - Windows 10以降 / macOS 10.14以降
   - メモリ: 2GB以上推奨
   
   ### 技術スタック
   - Python 3.11+
   - PySide6 6.6.0
   - python-barcode, qrcode, reportlab, openpyxl
   ```

3. **「Publish release」ボタンをクリック**

---

## 🎊 完了！

リリースを公開すると：

1. ⏳ **GitHub Actionsが自動起動**
2. 🔨 **Windows版ビルド**（約5-10分）
3. 🔨 **macOS版ビルド**（約5-10分）
4. ✅ **実行ファイルが自動追加**

### ビルド進捗確認：
```
https://github.com/seyaytua/barcode/actions
```

### 完成したリリースページ：
```
https://github.com/seyaytua/barcode/releases/tag/v2.0.3
```

---

## 📝 変更内容の詳細

### 修正した問題
**エラーメッセージ:**
```
PermissionError: [WinError 32] プロセスはファイルにアクセスできません
```

**原因:**
- `tempfile.NamedTemporaryFile`がWindowsで適切にファイルハンドルを閉じていなかった

**解決策:**
- `tempfile.mkstemp()`を使用
- ファイルディスクリプタを明示的に閉じる
- エラーハンドリングを改善

### 修正されたコード
```python
# 修正前
with tempfile.NamedTemporaryFile(delete=False, suffix='.png') as f:
    code_img.save(f.name)
    try:
        c.drawImage(f.name, ...)
    finally:
        os.unlink(f.name)

# 修正後
fd, temp_path = tempfile.mkstemp(suffix='.png')
try:
    os.close(fd)  # ファイルハンドルを閉じる
    code_img.save(temp_path)
    c.drawImage(temp_path, ...)
finally:
    try:
        os.unlink(temp_path)
    except:
        pass  # 削除失敗しても続行
```

---

## 🎯 まとめ

**実行する作業：**
1. ✅ リリースページで「v2.0.3」を作成（3分）
2. ⏳ ビルド完了を待つ（10分）

**合計：約13分で完成！**

PDF保存エラーが修正され、Windows環境で正常に動作します！
